
DROP TABLE EMP_INFO;

CREATE TABLE EMP_INFO (
	EMPID  VARCHAR(225) PRIMARY KEY,
	FIRST_NAME VARCHAR(225),
	LAST_NAME VARCHAR(225),
	PHONE VARCHAR(225),
	STARTDATE VARCHAR(225),
	DEPARTMENT VARCHAR(255),
	SALARY INT
);


INSERT INTO EMP_INFO
VALUES
	('EMP001','John', 'Wick', '12345678','2019','FINANCE',10000),
	('EMP002','Kevin', 'Hich', '12345678','2020','IT',15000),
	('EMP003','Mike', 'Claud', '12345678','2021','HR',7000),
	('EMP004','Jack', 'Micheal', '12345678','2019','IT',11000),
	('EMP005','Len', 'De souza', '12345678','2021','FINANCE',6500),
	('EMP006','Asma', 'Garner', '12345678','2022','SALES',13000),
	('EMP007','John', 'Wish', '12345678','2021','HR',10000),
	('EMP008','Jim', 'Oscar', '12345678','2019','SALES',12500),
	('EMP009','Finn', 'Demary', '12345678','2020','IT',17500),
	('EMP010','Maria', 'Ness', '12345678','2022','FINANCE',9000)
;

SELECT * FROM EMP_INFO;

DROP TABLE EMP_LOCATION;


CREATE TABLE EMP_LOCATION (
	EMPID VARCHAR(225),
	EMP_CITY VARCHAR(225),
	EMP_COUNTRY VARCHAR(225),
	SALES INT
);

INSERT INTO EMP_LOCATION
VALUES
	('EMP001','BANGALORE','INDIA', 5000),
	('EMP002','CALIFORNIA','USA', 7500),
	('EMP003','DUBAI','UAE', 3000),
	('EMP004','DELHI','INDIA', 4000),
	('EMP005','DUBAI','UAE', 5500),
	('EMP006','BANGALORE','INDIA', 3500),
	('EMP007','FLORIDA','USA', 6500),
	('EMP008','CALIFORNIA','USA', 9000),
	('EMP009','HYDERABAD','INDIA', 8000),
	('EMP010','CHESTER','USA', 5500)
;

SELECT * FROM EMP_INFO;

SELECT * FROM EMP_LOCATION;


CREATE VIEW FINAL3 AS
SELECT I.*, L.EMP_CITY, L.EMP_COUNTRY, L.SALES 
FROM EMP_INFO I
LEFT JOIN EMP_LOCATION AS L ON
I.EMPID = L.EMPID;


SELECT * FROM FINAL3;


SELECT EMP_COUNTRY, STARTDATE, SUM(SALES) AS TOTAL_REV 
FROM FINAL3 
GROUP BY EMP_COUNTRY, STARTDATE;


-- CALC. YEAR - COUNTRY WISE CONTRIBUTION I.E. COUNTRY WISE SALES DIVIDED BY TOTAL SALES OF THAT YEAR ?