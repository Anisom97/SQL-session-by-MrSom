CREATE DATABASE RETURNS_PRACTICE;

USE RETURNS_PRACTICE;

CREATE TABLE TRANSACTION_V1
( AMPERITY_ID VARCHAR(255)
, ORDER_DATETIME DATE
, ORDER_ID VARCHAR(255)
, PRODUCT_ID VARCHAR(255)
, ITEM_QUANTITY INT
, IS_RETURN VARCHAR(255)
, IS_CANCELLATION VARCHAR(255)
, ITEM_REVENUE FLOAT
);

INSERT INTO TRANSACTION_V1 VALUES
('1001','2022-01-13','2001','P1',1,'FALSE','FALSE',40.50)
,('1001','2022-01-21','2001','P2',-1,'TRUE','FALSE',14.50)

,('1002','2022-02-21','2002','P5',1,'FALSE','FALSE',20.60)

,('1003','2022-02-11','2011','P3',1,'FALSE','FALSE',50.20)
,('1003','2022-02-11','2011','P4',-1,'TRUE','FALSE',17.50)
,('1003','2022-01-11','2011','P1',-1,'TRUE','FALSE',29.30)

,('1001','2022-03-13','2009','P4',1,'FALSE','FALSE',30.50)

,('1004','2022-02-13','2023','P5',-1,'TRUE','FALSE',10.70)

,('1005','2022-03-10','2021','P1',-1,'TRUE','FALSE',26.50)

,('1006','2022-02-16','2045','P6',1,'FALSE','FALSE',55.50)
,('1006','2022-02-16','2045','P1',1,'FALSE','FALSE',49.50)

,('1007','2022-01-10','2020','P9',1,'FALSE','FALSE',90.50)

,('1008','2022-01-15','2019','P1',-1,'TRUE','FALSE',16.80)
,('1008','2022-01-16','2030','P1',1,'FALSE','FALSE',80.50)

,('1009','2022-03-13','2015','P3',1,'FALSE','FALSE',40.50)

,('1010','2022-03-13','2012','P8',1,'FALSE','FALSE',40.50)

,('1011','2022-03-13','2013','P4',-1,'TRUE','FALSE',32.30)

,('1012','2022-02-13','2099','P1',1,'FALSE','FALSE',40.50)

,('1013','2022-01-13','2081','P3',1,'FALSE','FALSE',40.50)

,('1014','2022-01-13','2071','P5',-1,'TRUE','FALSE',18.90)
;

SELECT * FROM TRANSACTION_V1;

CREATE TABLE CUST_360_INFO_V1
( AMP_ID VARCHAR(255)
, CUSTOMER_SEGMENTS VARCHAR(255)
, TIER_NAME VARCHAR(255)
, LAST_ACTIVITY_DATE DATE
);

INSERT INTO CUST_360_INFO_V1 VALUES
('1001','CLASSIC','ICON','2022-01-10')
,('1002','TREND DEE','DEVOTEE','2022-01-23')
,('1001','CLASSIC','OFFICIAL','2022-01-24')
,('1003','FASHION','OFFICIAL','2022-01-27')
,('1004','TREND DEE','DEVOTEE','2022-03-19')
,('1005','TREND DEE','OFFICIAL','2022-02-14')
,('1002','TREND DEE','ICON','2022-02-23')
,('1006',NULL,'ICON','2022-02-24')
,('1007',NULL,'DEVOTEE','2022-02-25')
,('1008','CLASSIC','ICON','2022-03-12')
,('1009',NULL,NULL,'2022-01-09')
,('1010',NULL,NULL,'2022-03-14')
,('1011',NULL,'DEVOTEE','2022-02-15')
,('1012','FASHION','OFFICIAL','2022-01-19')
,('1013','CLASSIC',NULL,'2022-03-23')
,('1014','TREND DEE','ICON','2022-03-23')
;


SELECT * FROM CUST_360_INFO_V1;

CREATE TABLE CUSTSEGROLL_V1 
( AMPERITY_ID VARCHAR(255)
, SEGMENT VARCHAR(255)
);

INSERT INTO CUSTSEGROLL_V1 VALUES
('1001','CLASSIC')
,('1005','TREND DEE')
,('1006','FASHION')
,('1007','FASHION')
,('1009',NULL)
,('1010','CLASSIC')
,('1011','TREND DEE')
;

SELECT * FROM CUSTSEGROLL_V1;

CREATE TABLE CALENDER
( DAY_NAME DATE,
 MONTH_NUMBER INT);

INSERT INTO CALENDER VALUES
('2022-01-10',1)
,('2022-01-23',1)
,('2022-01-24',1)
,('2022-01-27',1)
,('2022-03-19',3)
,('2022-02-14',2)
,('2022-02-23',2)
,('2022-02-24',2)
,('2022-02-25',2)
,('2022-03-12',3)
,('2022-01-09',1)
,('2022-03-14',3)
,('2022-02-15',2)
,('2022-01-19',1)
,('2022-03-23',3)
;

 SELECT * FROM CALENDER;
 
 CREATE TABLE ORDER_RETTYPE (
ORDER_NO VARCHAR(255)
, SKU_NO VARCHAR(255)
, RETURN_TYPE VARCHAR(255)
);

INSERT INTO ORDER_RETTYPE VALUES 
('2001','P2','Dc return')
,('2011','P4','DC return')
,('2011','P1','Store return')
,('2023','P5','dc return')
,('2021','P1','store return')
,('2019','P1','DC return')
,('2013','P4','store return')
,('2071','P5','Store return')
;
